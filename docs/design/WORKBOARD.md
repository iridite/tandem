# Workboard

## Status Key

- `todo`: not started
- `in_progress`: currently being executed
- `blocked`: waiting on dependency/decision
- `done`: implemented and verified

## Work Items

| ID    | Phase | Title                                                                                     | Source Spec               | Owner | Status | Acceptance                                                                                                         |
| ----- | ----- | ----------------------------------------------------------------------------------------- | ------------------------- | ----- | ------ | ------------------------------------------------------------------------------------------------------------------ |
| W-001 | 1     | Shared resources store schema + persistence                                               | `SHARED_RESOURCES.md`     | Codex | done   | Resource keys support rev + optimistic concurrency                                                                 |
| W-002 | 1     | Resource HTTP endpoints (`GET/PUT/PATCH/events`)                                          | `SHARED_RESOURCES.md`     | Codex | done   | API responds and emits SSE events by prefix                                                                        |
| W-003 | 1     | Resource event contract snapshots                                                         | `IMPLEMENTATION_PLAN.md`  | Codex | done   | Snapshot tests for `resource.*` payload shape                                                                      |
| W-013 | 1     | Status indexer from run/tool events into shared resources                                 | `IMPLEMENTATION_PLAN.md`  | Codex | done   | Derive `run/{sessionID}/status` from `session.run.*` and tool `message.part.updated` events                        |
| W-004 | 2     | Extract orchestrator crate scaffold                                                       | `ORCHESTRATOR.md`         | Codex | done   | New crate compiles and desktop adapters build                                                                      |
| W-005 | 2     | Mission reducer core types and trait                                                      | `ORCHESTRATOR.md`         | Codex | done   | `init`/`on_event` interface implemented                                                                            |
| W-014 | 2     | Mission runtime API scaffold in server (`create/get/list/apply event`)                    | `ORCHESTRATOR.md`         | Codex | done   | Mission events apply through reducer and return commands                                                           |
| W-006 | 3     | Reviewer/tester gates in mission flow                                                     | `DEFAULT_MISSION_FLOW.md` | Codex | done   | Gate failures return work item to rework state                                                                     |
| W-007 | 4     | Memory governance API handlers (`put/promote/search`)                                     | `MEMORY_TIERS.md`         | Codex | done   | Endpoints enforce capability + partition checks                                                                    |
| W-008 | 4     | Memory promotion scrub + audit pipeline                                                   | `MEMORY_TIERS.md`         | Codex | done   | Promotion blocked/redacted/passed with audit record                                                                |
| W-009 | 5     | Routine scheduler persistence + misfire policies                                          | `ROUTINES_CRON.md`        | Codex | done   | `skip/run_once/catch_up(n)` verified                                                                               |
| W-015 | 5     | Routine engine API scaffold (`create/list/patch/delete/run-now/history/events`)           | `ROUTINES_CRON.md`        | Codex | done   | Endpoints manage routines and emit/watch lifecycle events                                                          |
| W-010 | 5     | User routine controls (create/edit/pause/run-now/delete)                                  | `ROUTINES_CRON.md`        | Codex | done   | Desktop + TUI controls functional                                                                                  |
| W-011 | 5     | Connector-side-effect policy gates for routines                                           | `ROUTINES_CRON.md`        | Codex | done   | External side effects require policy/approval by default                                                           |
| W-012 | 6     | Desktop + TUI parity wiring to engine-hosted orchestrator APIs                            | `IMPLEMENTATION_PLAN.md`  | Codex | done   | Both clients can observe/control same run                                                                          |
| W-016 | 6     | Phase 6 docs/control-plane reconciliation for orchestrator naming + source-of-truth links | `README.md`               | Codex | done   | Docs cleanly distinguish implemented vs roadmap and link to active specs without stale claims                      |
| W-017 | 6     | Control-center operator UX refinement backlog (Desktop + TUI)                             | `IMPLEMENTATION_PLAN.md`  | Codex | done   | Phase 6 operator workflows and acceptance checks are explicitly defined for both clients                           |
| W-018 | 6     | SDK ergonomics and contract hardening backlog for third-party builders                    | `IMPLEMENTATION_PLAN.md`  | Codex | done   | Remaining stable API/event contracts and contract-test coverage are enumerated with owners                         |
| W-019 | 6     | SDK contract test coverage expansion plan                                                 | `SDK_CONTRACTS.md`        | Codex | done   | Mission/routine event contract families are snapshot-tested, parity-checked in Desktop/TUI, and promoted to stable |
| W-020 | 7     | Dynamic orchestrator role-map routing + legacy compatibility                              | `ORCHESTRATOR.md`         | Codex | done   | Legacy planner/builder/validator payloads and new role-map payloads are both normalized to canonical role routing  |
| W-021 | 7     | Control Center role-model UX alignment and naming cleanup                                 | `ENGINE_VS_UI.md`         | Codex | done   | Command Center distinguishes orchestrator role-model routing from operator agent-team controls                     |
| W-022 | 7     | Role-aware planner task schema (`assigned_role`, `template_id`, `gate`)                   | `DEFAULT_MISSION_FLOW.md` | Codex | done   | Planner task parsing and persisted task schema support role assignment, template hint, and gate metadata           |
| W-023 | 7     | Role-aware orchestrator task dispatch engine                                              | `ORCHESTRATOR.md`         | Codex | done   | Task execution routes model selection and dispatch by assigned role with fallback + warnings                       |
| W-024 | 7     | Reviewer/tester gate integration in orchestrator execution                                | `DEFAULT_MISSION_FLOW.md` | Codex | done   | Validation role honors task gate metadata (`review`/`test`) and surfaces gate labels in operator task board        |
| W-025 | 7     | Migration + contract + parity coverage for multi-role routing                             | `SDK_CONTRACTS.md`        | Codex | done   | Load-time migration normalizes legacy runs and build/check pipelines verify desktop+tauri compile parity           |
| CTX-001 | 1   | Source-of-truth contract enforcement (engine-owned run/step/events)                       | Context-driving plan      | Codex | done   | UI status derives from run state + structured events, not transcript/log inference                                 |
| CTX-002 | 1   | PR1 backend sequenced event log + event query API                                         | Context-driving plan      | Codex | done   | `events.jsonl` append-only with monotonic seq; Tauri query API and HTTP `/run/{id}/events` SSE support `since_seq` + `tail` |
| CTX-003 | 1   | PR1 UI/TUI status + structured event rendering                                             | Context-driving plan      | Codex | done   | Canonical run/step statuses rendered with badges; structured event payload rows are expandable                     |
| CTX-004 | 1   | PR2 workspace lease model + validation hooks                                               | Context-driving plan      | Codex | done   | Run state stores workspace lease and validates before dispatch/tool calls                                           |
| CTX-005 | 1   | PR2 mismatch behavior: emit workspace_mismatch + auto-pause                                | Context-driving plan      | Codex | done   | Lease mismatch emits reliability event and transitions run to paused by default                                     |
| CTX-006 | 1   | PR3 minimal ContextPackBuilder                                                             | Context-driving plan      | Codex | done   | Context pack built per selected step using goal + constraints + active step + last events + summary placeholder   |
| CTX-007 | 1   | PR3 required why_next_step + dispatch wiring                                               | Context-driving plan      | Codex | done   | Selected step writes required `why_next_step` and emits `context_pack_built`                                       |
| CTX-008 | 2   | Blackboard append-only patches + materialized view (no UI edit)                            | Context-driving plan      | Codex | done   | `blackboard_patches.jsonl` + `blackboard.json` persisted by engine patch stream; read-only UI/commands only (no patch endpoint) |
| CTX-009 | 1   | PR1 parity endpoint: `GET /run/{id}/events` SSE (tail + live + reconnect via `since_seq`) | Context-driving plan      | Codex | done   | HTTP/SSE route streams sequenced run-event records with tail bootstrap and live polling updates                    |
| CTX-010 | 1   | PR1 event replay invariant tests                                                           | Context-driving plan      | Codex | done   | Store-level sequenced event tests verify monotonic append, `since_seq`, and `tail` replay invariants               |
| CTX-011 | 2   | Checkpoint manager (`checkpoints/<seq>.json`) + latest-checkpoint resume path             | Context-driving plan      | Codex | done   | Engine writes checkpoints on heartbeat + key transitions; `orchestrator_load_run` restores latest checkpoint state |
| CTX-012 | 2   | Retry failure classifier (explicit class -> pause/retry/fail policy)                       | Context-driving plan      | Codex | done   | `mark_task_error` uses central failure classifier + policy mapping and emits `RETRY_CLASSIFIED` trace              |
| CTX-013 | 2   | Rolling summary compaction with pinned-constraint preservation                              | Context-driving plan      | Codex | done   | Context pack summary compaction preserves pinned constraints and blackboard rolling summary remains bounded         |
| CTX-ENG-001 | 1 | Engine-owned context run API (RunState/events/lease/blackboard/checkpoints)               | Context-driving plan      | Codex | done   | `tandem-engine` exposes `/context/runs/*` CRUD + event append/list/SSE + lease validate + blackboard patches + checkpoints |
| CTX-ENG-002 | 1 | Migrate Desktop to engine `/context/runs/*` source-of-truth                                 | Context-driving plan      | Codex | done   | Orchestrator panel + Command Center run lifecycle/status/events/blackboard route through engine context-run commands |
| CTX-ENG-003 | 1 | Migrate TUI to engine `/context/runs/*` source-of-truth                                     | Context-driving plan      | Codex | done   | TUI context-run commands/views consume engine context-run endpoints and avoid local run-state inference                |
| CTX-ENG-004 | 1 | Add TUI context-run endpoint contract tests                                                  | Context-driving plan      | Codex | done   | `tandem-tui` client tests cover context run list/get/events/append/blackboard endpoint contracts                       |
| CTX-ENG-005 | 3 | Engine deterministic context-run replay endpoint (`events + checkpoints -> drift report`)    | Context-driving plan      | Codex | done   | `/context/runs/{run_id}/replay` returns materialized replay state and drift flags vs persisted state                   |
| CTX-ENG-006 | 3 | Engine `ContextDriver` next-step selector (meta-manager core)                                | Context-driving plan      | Codex | done   | `/context/runs/{run_id}/driver/next` selects next step from run state, writes `why_next_step`, and emits decision event |
| CTX-ENG-007 | 3 | TUI access to ContextDriver/replay engine endpoints                                            | Context-driving plan      | Codex | done   | TUI supports `/context_run_next` and `/context_run_replay` using engine-owned endpoints with contract tests             |
| CTX-ENG-008 | 3 | ContextDriver guardrail tests (dry-run + event emission invariants)                           | Context-driving plan      | Codex | done   | Engine tests verify dry-run does not mutate state/events and applied mode emits `meta_next_step_selected` with reason   |
| CTX-ENG-009 | 3 | TUI decision-lineage view for meta-manager decisions                                           | Context-driving plan      | Codex | done   | `/context_run_lineage` renders sequenced `meta_next_step_selected` history with `why_next_step` from engine events      |
| CTX-ENG-010 | 3 | Fault-injection recovery test: workspace mismatch -> checkpoint -> replay                       | Context-driving plan      | Codex | done   | Engine test verifies fault path emits reliability events, pauses run, checkpoints state, and replay shows no drift       |
| CTX-ENG-011 | 3 | Todo/task flow bridge into context-run step state                                               | Context-driving plan      | Codex | done   | Engine `/context/runs/{run_id}/todos/sync` + TUI bind/sync commands keep `todowrite` tasks aligned with context steps   |
| CTX-ENG-012 | 3 | Desktop Blackboard panel (Orchestrator + Command Center) with docked/expanded/fullscreen modes | `docs/BLACKBOARD_VIEWS.md` | Codex | done   | Shared panel renders engine-truth progress + decision lineage (`why_next_step`) + replay drift/checkpoint indicators     |
| CTX-ENG-013 | 3 | Blackboard panel automated coverage (projection/filtering + drift/lineage rendering contracts)    | `docs/BLACKBOARD_VIEWS.md` | Codex | done   | Component/contract tests assert projected nodes, filters, lineage ordering by `seq`, and drift/checkpoint badge behavior |

## Backlog Intake Rules

- Add new work item with unique `W-###`.
- Link to exact spec file.
- Define measurable acceptance in one line.
- Do not start implementation until item is `in_progress`.
